<div class="accounts-container">
  @if (isLoggedIn()) {
    <div class="profile-section">
      <div class="profile-card">
        <div class="profile-header">
          <div class="profile-avatar">
            <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
              <circle cx="12" cy="7" r="4"></circle>
            </svg>
          </div>
          <div class="profile-title">
            <h1>{{ currentUser()?.username }}{{ 'accounts.profile.title' | translate }}</h1>
            <p class="role-badge">{{ currentUser()?.role | uppercase }}</p>
          </div>
        </div>

        <div class="profile-info">
          <div class="info-group">
            <label>{{ 'accounts.profile.username' | translate }}:</label>
            <p>{{ currentUser()?.username || 'N/A' }}</p>
          </div>
          <div class="info-group">
            <label>{{ 'accounts.profile.email' | translate }}:</label>
            <p>{{ currentUser()?.email || 'N/A' }}</p>
          </div>
          <div class="info-group">
            <label>{{ 'accounts.profile.birthdate' | translate }}:</label>
            <p>{{ currentUser()?.birthdate ? (currentUser()?.birthdate | date: 'dd/MM/yyyy') : 'N/A' }}</p>
          </div>
          <div class="info-group">
            <label>{{ 'accounts.profile.userId' | translate }}:</label>
            <p>{{ currentUser()?.id || 'N/A' }}</p>
          </div>
        </div>

        <button class="btn btn-logout" (click)="onLogout()">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
            <polyline points="16 17 21 12 16 7"></polyline>
            <line x1="21" y1="12" x2="9" y2="12"></line>
          </svg>
          {{ 'accounts.profile.logout' | translate }}
        </button>
      </div>
    </div>
  }

  <!-- Auth Forms Section (displayed when not logged in) -->
  @if (!isLoggedIn()) {
    <div class="auth-container">
      <!-- Messages -->
      @if (errorMessage()) {
        <div class="alert alert-error">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="8" x2="12" y2="12"></line>
            <line x1="12" y1="16" x2="12.01" y2="16"></line>
          </svg>
          {{ errorMessage() }}
        </div>
      }
      @if (successMessage()) {
        <div class="alert alert-success">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="20 6 9 17 4 12"></polyline>
          </svg>
          {{ successMessage() }}
        </div>
      }

      <!-- Login Form -->
      @if (!showRegister()) {
        <div class="form-section login-section">
          <div class="form-header">
            <h2>{{ 'accounts.login.title' | translate }}</h2>
            <p>{{ 'accounts.login.subtitle' | translate }}</p>
          </div>

          <form (ngSubmit)="onLogin()" class="auth-form">
            <div class="form-group">
              <label for="login-username">{{ 'accounts.login.username' | translate }}</label>
              <input
                type="text"
                id="login-username"
                class="form-control"
                [ngModel]="loginForm().username"
                (ngModelChange)="updateLoginForm('username', $event)"
                name="login-username"
                [placeholder]="'accounts.login.usernameplaceholder' | translate"
                required
              />
            </div>

            <div class="form-group">
              <label for="login-password">{{ 'accounts.login.password' | translate }}</label>
              <input
                type="password"
                id="login-password"
                class="form-control"
                [ngModel]="loginForm().password"
                (ngModelChange)="updateLoginForm('password', $event)"
                name="login-password"
                [placeholder]="'accounts.login.passwordplaceholder' | translate"
                required
              />
            </div>

            <button
              type="submit"
              class="btn btn-primary btn-block"
              [disabled]="isLoading()"
            >
              @if (isLoading()) {
                <span class="spinner"></span>
                {{ 'accounts.login.logging' | translate }}
              } @else {
                {{ 'accounts.login.button' | translate }}
              }
            </button>
          </form>

          <div class="form-footer">
            <p>{{ 'accounts.login.noAccount' | translate }}
              <button type="button" class="link-btn" (click)="toggleRegister()">
                {{ 'accounts.login.register' | translate }}
              </button>
            </p>
          </div>
        </div>
      }

      <!-- Register Form -->
      @if (showRegister()) {
        <div class="form-section register-section">
          <div class="form-header">
            <h2>{{ 'accounts.register.title' | translate }}</h2>
            <p>{{ 'accounts.register.subtitle' | translate }}</p>
          </div>

          <form (ngSubmit)="onRegister()" class="auth-form">
            <div class="form-group">
              <label for="register-username">{{ 'accounts.register.username' | translate }}</label>
              <input
                type="text"
                id="register-username"
                class="form-control"
                [ngModel]="registerForm().username"
                (ngModelChange)="updateRegisterForm('username', $event)"
                name="register-username"
                [placeholder]="'accounts.register.usernameplaceholder' | translate"
                required
              />
            </div>

            <div class="form-group">
              <label for="register-email">{{ 'accounts.register.email' | translate }}</label>
              <input
                type="email"
                id="register-email"
                class="form-control"
                [ngModel]="registerForm().email"
                (ngModelChange)="updateRegisterForm('email', $event)"
                name="register-email"
                [placeholder]="'accounts.register.emailplaceholder' | translate"
                required
              />
            </div>

            <div class="form-group">
              <label for="register-birthdate">{{ 'accounts.register.birthdate' | translate }}</label>
              <input
                type="date"
                id="register-birthdate"
                class="form-control"
                [ngModel]="registerForm().birthdate"
                (ngModelChange)="updateRegisterForm('birthdate', $event)"
                name="register-birthdate"
                [placeholder]="'accounts.register.birthdateplaceholder' | translate"
                required
              />
            </div>

            <div class="form-group">
              <label for="register-password">{{ 'accounts.register.password' | translate }}</label>
              <input
                type="password"
                id="register-password"
                class="form-control"
                [ngModel]="registerForm().password"
                (ngModelChange)="updateRegisterForm('password', $event)"
                name="register-password"
                [placeholder]="'accounts.register.passwordplaceholder' | translate"
                required
              />
            </div>

            <div class="form-group">
              <label for="register-confirm">{{ 'accounts.register.confirmPassword' | translate }}</label>
              <input
                type="password"
                id="register-confirm"
                class="form-control"
                [ngModel]="registerForm().confirmPassword"
                (ngModelChange)="updateRegisterForm('confirmPassword', $event)"
                name="register-confirm"
                [placeholder]="'accounts.register.confirmpasswordplaceholder' | translate"
                required
              />
            </div>

            <button
              type="submit"
              class="btn btn-primary btn-block"
              [disabled]="isLoading()"
            >
              @if (isLoading()) {
                <span class="spinner"></span>
                {{ 'accounts.register.creating' | translate }}
              } @else {
                {{ 'accounts.register.button' | translate }}
              }
            </button>
          </form>

          <div class="form-footer">
            <p>{{ 'accounts.register.haveAccount' | translate }}
              <button type="button" class="link-btn" (click)="toggleRegister()">
                {{ 'accounts.register.login' | translate }}
              </button>
            </p>
          </div>
        </div>
      }
    </div>
  }
</div>
